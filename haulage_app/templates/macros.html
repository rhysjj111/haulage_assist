from datetime import datetime
<!----------------------------- navigation macros -->

{% macro nav_link(name, endpoint) %}
        {% if ((request.endpoint in varargs) or (request.endpoint == endpoint)) %}
            <li class="tab active"><a class="menu-tab-link" href="{{ url_for(endpoint) }}">{{ name }}</a></li>
        {% else %}
            <li class ="tab"><a class="menu-tab-link" href="{{ url_for(endpoint) }}">{{ name }}</a></li>
        {% endif %}
{% endmacro %}


<!----------------------------- question list macros -->

{% macro driver(type, driver, trucks, f) %}
    <!-- first name -->
    <div class="row">
        <div class="input-field col s12">
            <!-- <i class="fas fa-pencil-alt prefix light-blue-text text-darken-4"></i> -->
            <input id="first_name" name="first_name" type="text" required
            {% if driver.first_name is defined %} 
                value="{{ driver.first_name }}" 
            {% endif %}
            >
            <label for="first_name">First name: {{driver.truck_id}}</label>
        </div>
    </div>
    
    <!-- last name -->
    <div class="row">
        <div class="input-field col s12">
            <!-- <i class="fas fa-pencil-alt prefix light-blue-text text-darken-4"></i> -->
            <input id="last_name" name="last_name" type="text" required
                {% if driver.last_name is defined %} 
                    value="{{ driver.last_name }}" 
                {% endif %}
                >
            <label for="last_name">Last name:</label>
        </div>
    </div>

    <!-- basic wage -->
    <div class="row">
        <div class="input-field col s12">
            <!-- <i class="fas fa-pencil-alt prefix light-blue-text text-darken-4"></i> -->
            <input id="basic_wage" name="basic_wage" type="number" step="0.01" required
                    {% if driver.basic_wage is defined and type == "edit" %} 
                        value="{{'%0.2f' % f.display_float(driver.basic_wage) }}" 
                    {% elif driver.basic_wage is defined %} 
                        value="{{driver.basic_wage}}" 
                    {% endif %}
                    >
            <label for="basic_wage">Basic wage (£):</label>
        </div>
    </div>

    <!-- Daily-bonus threshold -->
    <div class="row">
        <div class="input-field col s12">
            <!-- <i class="fas fa-pencil-alt prefix light-blue-text text-darken-4"></i> -->
            <input id="daily_bonus_threshold" name="daily_bonus_threshold" type="number" step="0.01" required
                    {% if driver.daily_bonus_threshold is defined and type == "edit" %} 
                        value="{{'%0.2f' % f.display_float(driver.daily_bonus_threshold) }}" 
                    {% elif driver.daily_bonus_threshold is defined %} 
                        value="{{driver.daily_bonus_threshold}}" 
                    {% endif %}
                    >
            <label for="daily_bonus_threshold">Daily-bonus threshold (£):</label>
        </div>
    </div>

    <!-- Daily-bonus percentage -->
    <div class="row">
        <div class="input-field col s12">
            <!-- <i class="fas fa-pencil-alt prefix light-blue-text text-darken-4"></i> -->
            <input id="daily_bonus_percentage" name="daily_bonus_percentage" type="number" step="0.01" required
                {% if driver.daily_bonus_percentage is defined and type == "edit" %} 
                    value="{{'%0.2f' % f.display_percentage(driver.daily_bonus_percentage) }}" 
                {% elif driver is defined %}
                    value="{{driver.daily_bonus_percentage}}"
                {% endif %}
                >
            <label for="daily_bonus_percentage">Daily-bonus percentage (%):</label>
        </div>
    </div>

    <!-- Weekly-bonus threshold -->
    <div class="row">
        <div class="input-field col s12">
            <!-- <i class="fas fa-pencil-alt prefix light-blue-text text-darken-4"></i> -->
            <input id="weekly_bonus_threshold" name="weekly_bonus_threshold" type="number" step="0.01" required
                    {% if driver.weekly_bonus_threshold is defined and type == "edit" %} 
                        value="{{'%0.2f' % f.display_float(driver.weekly_bonus_threshold) }}" 
                    {% elif driver.weekly_bonus_threshold is defined %} 
                        value="{{driver.weekly_bonus_threshold}}" 
                    {% endif %}
                    >
            <label for="weekly_bonus_threshold">Weekly-bonus threshold (£):</label>
        </div>
    </div>

    <!-- Weekly-bonus percentage -->
    <div class="row">
        <div class="input-field col s12">
            <!-- <i class="fas fa-pencil-alt prefix light-blue-text text-darken-4"></i> -->
            <input id="weekly_bonus_percentage" name="weekly_bonus_percentage" type="number" step="0.01" required
                {% if driver.weekly_bonus_percentage is defined and type == "edit" %} 
                    value="{{'%0.2f' % f.display_percentage(driver.weekly_bonus_percentage) }}" 
                {% elif driver is defined %}
                    value="{{driver.weekly_bonus_percentage}}"
                {% endif %}
                >
            <label for="weekly_bonus_percentage">Weekly-bonus percentage (%):</label>
        </div>
    </div>
    
    <!-- overnight -->
    <div class="row">
        <div class="input-field col s12">
            <!-- <i class="fas fa-pencil-alt prefix light-blue-text text-darken-4"></i> -->
            <input id="overnight_value" name="overnight_value" type="number" step="0.01" required
                {% if driver.overnight_value is defined and type == "edit" %} 
                    value="{{'%0.2f' % f.display_float(driver.overnight_value) }}" 
                {% elif driver is defined %}
                    value="{{driver.overnight_value}}"
                {% endif %}
                >
            <label for="overnight_value">Overnight value (£):</label>
        </div>
    </div>

    <!-- preferred truck -->
    <div class="row">
        <div class="input-field col s12">
            <!-- <i class="fas fa-calendar prefix light-blue-text text-darken-4"></i> -->  
            <select name="truck_id" id="truck_id" class="validate" required>
                {% if driver.truck_id is defined %}
                    {% for truck in trucks %}
                        {% if driver.truck_id == truck.id %}
                            <option value="{{ truck.id }}" selected>{{ truck.registration }}</option>
                        {% else %}
                            <option value="{{ truck.id }}">{{ truck.registration }}</option>
                        {% endif %}
                    {% endfor %}        
                {% else %}
                    <option value="" disabled selected></option>
                    {% for truck in trucks %}
                            <option value="{{ truck.id }}" >{{ truck.registration }}</option>
                    {% endfor %}   
                {% endif %}
            </select>
            <label for="truck_id">Preferred Truck:</label>
        </div>
    </div>


    <!-- submit button -->
    <div class="row">
        <div class="col s12 center-align">
            <button type="submit" class="btn-large submit">
                Submit <i class="fas fa-edit right"></i>
            </button>
        </div>
    </div>
{% endmacro %}



{% macro truck(type, truck, f) %}
    <!-- reg -->
    <div class="row">
        <div class="input-field col s12">
            <!-- <i class="fas fa-pencil-alt prefix light-blue-text text-darken-4"></i> -->
            <input id="registration" name="registration" type="text" required
            {% if truck.registration is defined %} 
                value="{{ truck.registration }}" 
            {% endif %}
            >
            <label for="registration">Registration:</label>
        </div>
    </div>

    <!-- make -->
    <div class="row">
        <div class="input-field col s12">
            <!-- <i class="fas fa-pencil-alt prefix light-blue-text text-darken-4"></i> -->
            <input id="make" name="make" type="text" required
                    {% if truck.make is defined %} 
                        value="{{truck.make}}" 
                    {% endif %}
                    >
            <label for="make">Make:</label>
        </div>
    </div>

    <!-- model -->
    <div class="row">
        <div class="input-field col s12">
            <!-- <i class="fas fa-pencil-alt prefix light-blue-text text-darken-4"></i> -->
            <input id="model" name="model" type="text" required
                    {% if truck.model is defined %} 
                        value="{{truck.model}}" 
                    {% endif %}
                    >
            <label for="model">Model:</label>
        </div>
    </div>
    
    <!-- submit button -->
    <div class="row">
        <div class="col s12 center-align">
            <button type="submit" class="btn-large submit">
                Submit <i class="fas fa-edit right"></i>
            </button>
        </div>
    </div>
{% endmacro %}



{% macro day(type, day, components, f) %}
    <!-- status -->
    <div class="row">
        <div class="input-field col s12">
            <!-- <i class="fas fa-calendar prefix light-blue-text text-darken-4"></i> -->  
            <select name="status" id="status" class="validate" required>
                {% if day != {} and day.status is defined %}
                <option value="{{day.status}}" selected>{{day.status.capitalize()}}</option>
                <option value="working" >Working</option>
                <option value="holiday" >Holiday</option>
                <option value="absent" >Absent</option>
                {% else %}
                <option value="working" selected>Working</option>
                <option value="holiday" >Holiday</option>
                <option value="absent" >Absent</option>
                {% endif %}
            </select>
            <label for="status">Select status:</label>
        </div>
    </div>

    <!-- date -->
    <div class="row">
        <div class="input-field col s12">
            <!-- <i class="fas fa-calendar prefix light-blue-text text-darken-4"></i> -->
            <input id="date" name="date"  type="text" class="datepicker" required
                {% if day is defined and type == 'edit' %} 
                    value="{{ day.date }}" 
                {% elif day is defined %}
                    value="{{ day.date }}"
                {% endif %}
                >
            <label for="date">Date:</label>
        </div>
    </div>

    <!-- driver -->
    <div class="row">
        <div class="input-field col s12">
            <!-- <i class="fas fa-calendar prefix light-blue-text text-darken-4"></i> -->  
            <select name="driver_id" id="driver_id" class="validate" required>
                {% if day.driver_id is defined %}
                    {% for driver in components.drivers %}
                        {% if day.driver_id|int == driver.id|int %}
                            <option value="{{ driver.id }}" selected>{{ driver.full_name }}</option>
                        {% else %}
                            <option value="{{ driver.id }}">{{ driver.full_name }}</option>
                        {% endif %}
                    {% endfor %}        
                {% else %}
                    <option value="" disabled selected>Please select</option>
                    {% for driver in components.drivers %}
                        <option value="{{ driver.id }}" >{{ driver.full_name }}</option>
                    {% endfor %}   
                {% endif %}
            </select>
            <label for="driver_id">Driver:</label>
        </div>
    </div>

    <!-- truck -->
    <div class="row working_question">
        <div class="input-field col s12">
            <!-- <i class="fas fa-calendar prefix light-blue-text text-darken-4"></i> -->  
            <select name="truck_id" id="truck_id" >
                {% if day != {}  and day.truck_id is defined %}
                    {% for truck in components.trucks %}
                       {% if day.truck_id|int == truck.id|int %}
                            <option value="{{ truck.id }}" selected>{{ truck.registration }}</option>
                        {% else %}
                            <option value="{{ truck.id }}">{{ truck.registration }}</option>
                        {% endif %}
                    {% endfor %}        
                {% else %}
                    <option value="" disabled selected>Please select</option>
                    {% for truck in components.trucks %}
                            <option value="{{ truck.id }}" >{{ truck.registration }}</option>
                    {% endfor %}   
                {% endif %}
            </select>
            <label for="truck_id">Truck:</label>
        </div>
    </div>
    
    <!-- overnight -->
    <div class="row working_question">
        <div class="input-field col s12">
            <div class="switch">
                <!-- <i class="fas fa-pencil-alt prefix light-blue-text text-darken-4"></i> -->
                {% if day != {} %}
                    <label for="overnight_{{ type }}_{{ day.id }}">
                        {% if day.overnight == True or day.overnight == "on" %}
                            <input id="overnight_{{ type }}_{{ day.id }}" name="overnight" type="checkbox" checked>
                        {% else %}
                            <input id="overnight_{{ type }}_{{ day.id }}" name="overnight" type="checkbox">
                        {% endif %}
                        <span class="lever"></span>
                        Overnight
                    </label>
                {% else %}
                    <label for="overnight_{{ type }}">
                        <input id="overnight_{{ type }}" name="overnight" type="checkbox" checked>
                        <span class="lever"></span>
                        Overnight
                    </label>                          
                {% endif %}
            </div>
        </div>
    </div>

    <!-- fuel -->
    <div class="row working_question">
        <div class="input-field col s12">
            <div class="switch">
                <!-- <i class="fas fa-pencil-alt prefix light-blue-text text-darken-4"></i> -->
                {% if day != {} %}
                    <label for="fuel_{{ type }}_{{ day.id }}">
                        {% if day.fuel == True or day.fuel == "on" %}
                            <input id="fuel_{{ type }}_{{ day.id }}" name="fuel" type="checkbox" checked>
                        {% else %}
                            <input id="fuel_{{ type }}_{{ day.id }}" name="fuel" type="checkbox">
                        {% endif %}
                        <span class="lever"></span>
                        Fuel
                    </label>
                {% else %}
                    <label for="fuel_{{ type }}">
                        <input id="fuel_{{ type }}" name="fuel" type="checkbox">
                        <span class="lever"></span>
                        Fuel
                    </label>                          
                {% endif %}
            </div>
        </div>
    </div>

    <!-- start mileage -->
    <div class="row working_question">
        <div class="input-field col s12">
            <!-- <i class="fas fa-pencil-alt prefix light-blue-text text-darken-4"></i> -->
            <input id="start_mileage" name="start_mileage" type="number" step="0.01"
                {% if day.start_mileage is defined %}
                    {% if type == "edit" and day.start_mileage == 0 %}
                        value="{{ none }}"
                    {% elif type == "edit" %}
                        value="{{ '%0.2f' % f.display_float(day.start_mileage) }}" 
                    {% else %}
                        value="{{ day.start_mileage }}" 
                    {% endif %}
                {% else %}
                    value="{{ none }}"
                {% endif %}
                >
            <label for="start_mileage">Start mileage:</label>
        </div>
    </div>

    <!-- end mileage -->
    <div class="row working_question">
        <div class="input-field col s12">
            <!-- <i class="fas fa-pencil-alt prefix light-blue-text text-darken-4"></i> -->
            <input id="end_mileage" name="end_mileage" type="number" step="0.01"
                {% if day.end_mileage is defined %}
                    {% if type == "edit" and day.end_mileage == 0 %}
                        value="{{ none }}"
                    {% elif type == "edit" %}
                        value="{{ '%0.2f' % f.display_float(day.end_mileage) }}" 
                    {% else %}
                        value="{{ day.end_mileage }}" 
                    {% endif %}
                {% else %}
                    value="{{ none }}"
                {% endif %}
                >
            <label for="end_mileage">End mileage:</label>
        </div>
    </div>

    <!-- additional earned -->
    <div class="row working_question">
        <div class="input-field col s12">
            <!-- <i class="fas fa-pencil-alt prefix light-blue-text text-darken-4"></i> -->
            <input id="additional_earned" name="additional_earned" type="number" step="0.01"
                {% if day.additional_earned is defined %}
                    {% if type == "edit" and day.additional_earned == 0 %}
                        value="{{ none }}"
                    {% elif type == "edit" %}
                        value="{{ '%0.2f' % f.display_float(day.additional_earned) }}" 
                    {% else %}
                        value="{{ day.additional_earned }}" 
                    {% endif %}
                {% else %}
                    value="{{ none }}"
                {% endif %}
                >
            <label for="additional_earned">Additional earned (£):</label>
        </div>
    </div>

    <!-- additional wages -->
    <div class="row working_question">
        <div class="input-field col s12">
            <!-- <i class="fas fa-pencil-alt prefix light-blue-text text-darken-4"></i> -->
            <input id="additional_wages" name="additional_wages" type="number" step="0.01"
                {% if day.additional_wages is defined %}
                    {% if type == "edit" and day.additional_wages == 0 %}
                        {# No value here #}
                    {% elif type == "edit" %}
                        value="{{ '%0.2f' % f.display_float(day.additional_wages) }}" 
                    {% else %}
                        value="{{ day.additional_wages }}" 
                    {% endif %}
                {% else %}
                    {# No value here #}
                {% endif %}
                > 
            <label for="additional_wages">Additional wages (£):</label>
        </div>
    </div>

    <!-- submit button -->
    <div class="row">
        <div class="col s12 center-align">
            <button type="submit" class="btn-large submit">
                Submit <i class="fas fa-edit right"></i>
            </button>
        </div>
    </div>
{% endmacro %}

{% macro week(day, components, f) %}
    <!-- hidden fields -->
    <div class="row">
        <div class="input-field col s12">
            <h5><strong>{{f.display_date(day.date)}}</strong> ({{ day.date.strftime("%A") }})</h5>
            <h5><strong>{{ day.driver.full_name }}</strong></h5>

            <input id="date" name="date"  type="hidden" value="{{ f.display_date(day.date) }}">
            <input id="driver_id" name="driver_id"  type="hidden" value="{{day.driver_id}}">
            <input id="truck_id" name="truck_id"  type="hidden" value="{{day.truck_id}}">
            <input id="status" name="status"  type="hidden" value="{{day.status}}">
            <input id="overnight" name="overnight"  type="hidden" value="{{'on' if day.overnight else ''}}">
            <input id="additional_earned" name="additional_earned"  type="hidden" value="{{day.additional_earned}}">
            <input id="additional_wages" name="additional_wages"  type="hidden" value="{{day.additional_wages}}">
        </div>
    </div>

    <!-- start mileage -->
    <div class="row">
        <div class="input-field col s12">
            <!-- <i class="fas fa-pencil-alt prefix light-blue-text text-darken-4"></i> -->
            <input id="start_mileage" name="start_mileage" type="number" step="0.01"
                {% if day.start_mileage == 0 %}
                    value="{{ none }}"
                {% else %}
                    value="{{ f.display_float(day.start_mileage) }}" 
                {% endif %}
                >
            <label for="start_mileage">Start mileage:</label>
        </div>
    </div>

    <!-- end mileage -->
    <div class="row">
        <div class="input-field col s12">
            <!-- <i class="fas fa-pencil-alt prefix light-blue-text text-darken-4"></i> -->
            <input id="end_mileage" name="end_mileage" type="number" step="0.01"
                {% if day.end_mileage == 0 %}
                    value="{{ none }}"
                {% else %}
                    value="{{ f.display_float(day.end_mileage) }}" 
                {% endif %}
                >
            <label for="end_mileage">End mileage:</label>
        </div>
    </div>

    <!-- fuel -->
    <div class="row">
        <div class="input-field col s12">
            <div class="switch">
                <!-- <i class="fas fa-pencil-alt prefix light-blue-text text-darken-4"></i> -->
                <label for="fuel_first_{{ day.id }}">
                    {% if day.fuel == True or day.fuel == "on" %}
                        <input id="fuel_first_{{ day.id }}" name="fuel" type="checkbox" checked>
                    {% else %}
                        <input id="fuel_first_{{ day.id }}" name="fuel" type="checkbox">
                    {% endif %}
                    <span class="lever"></span>
                    Fuel
                </label>
            </div>
        </div>
    </div>

    <!-- submit button -->
    <div class="row">
        <div class="col s12 center-align">
            <button type="submit" class="btn-large submit">
                Submit <i class="fas fa-edit right"></i>
            </button>
        </div>
    </div>
{% endmacro %}



{% macro job(type, job, components, f) %}
    <!-- date -->
    <div class="row">
        <div class="input-field col s12">
            <!-- <i class="fas fa-calendar prefix light-blue-text text-darken-4"></i> -->
            <input id="date_cd" name="date_cd"  type="text" class="datepicker" required
                {% if job is defined and type == 'edit' %} 
                    {% for day in components.days %}
                        {% if job.day_id == day.id %}
                            value="{{ day.date }}"
                        {% endif %}
                    {% endfor %}
                {% elif job is defined %}
                    value="{{job.date_cd}}"
                {% endif %}
                >
            <label for="date_cd">Date:</label>
        </div>
    </div>

    <!-- driver -->
    <div class="row">
        <div class="input-field col s12">
            <!-- <i class="fas fa-calendar prefix light-blue-text text-darken-4"></i> -->  
            <select name="driver_id" id="driver_id" class="validate" required>
                <!-- Check if job object exists (will only exist for edit and if form has an error) -->
                {% if job != {} %}
                    {% for driver in components.drivers %}
                        <!-- Check if form has been repopulated due to an error -->
                        {% if job.driver_id is defined %}
                            {% if job.driver_id|string == driver.id|string %}
                                <option value="{{ driver.id }}" selected>{{ driver.full_name }} </option>
                            {% else %}
                                <option value="{{ driver.id }}">{{ driver.full_name }}</option>
                            {% endif %}
                        <!-- Else, we are populating an edit form (job.driver_id is not available in this
                         case and we must loop through the list of day entries.) -->
                        {% else %}
                            {% for day in components.days %}
                                {% if job.day_id == day.id %}
                                    {% if day.driver_id|int == driver.id|int %}
                                        <option value="{{ driver.id }}" selected>{{ driver.full_name }}</option>
                                    {% elif job.driver_id == driver.id %}
                                        <option value="{{ driver.id }}" selected>{{ driver.full_name }}</option>
                                    {% else %}
                                        <option value="{{ driver.id }}">{{ driver.full_name }}</option>
                                    {% endif %}
                                {% endif %}
                            {% endfor %}
                        {% endif %}
                    {% endfor %}        
                {% else %}
                    <option value="" disabled selected>Please select</option>
                    {% for driver in components.drivers %}
                        <option value="{{ driver.id|int }}" >{{ driver.full_name }}{{ job.day_id }}{{ day.id }}</option>
                    {% endfor %}   
                {% endif %}
            </select>
            <label for="driver_id">Driver:</label>
        </div>
    </div>

    <!-- earned -->
    <div class="row">
        <div class="input-field col s12">
            <!-- <i class="fas fa-pencil-alt prefix light-blue-text text-darken-4"></i> -->
            <input id="earned" name="earned" type="number" step="0.01" step="0.01" required
                {% if job is defined and type == 'edit' %} 
                    value="{{'%0.2f' % f.display_float(job.earned) }}" 
                {% elif job is defined %}
                    value="{{ job.earned }}"
                {% endif %}
            >    
            <label for="earned">Earned (£):</label>
        </div>
    </div>

    <!-- collection -->
    <div class="row">
        <div class="input-field col s12">
            <!-- <i class="fas fa-pencil-alt prefix light-blue-text text-darken-4"></i> -->
            <input id="collection" name="collection" type="text" required
                    {% if job.collection is defined %} 
                        value="{{ job.collection }}" 
                    {% endif %}
                    >
            <label for="collection">Collection:</label>
        </div>
    </div>

    <!-- delivery -->
    <div class="row">
        <div class="input-field col s12">
            <!-- <i class="fas fa-pencil-alt prefix light-blue-text text-darken-4"></i> -->
            <input id="delivery" name="delivery" type="text" required
                    {% if job.delivery is defined %} 
                        value="{{ job.delivery }}" 
                    {% endif %}
                    >
            <label for="delivery">Delivery:</label>
        </div>
    </div>

    <!-- notes -->
    <div class="row">
        <div class="input-field col s12">
            <!-- <i class="fas fa-pencil-alt prefix light-blue-text text-darken-4"></i> -->
            <select name="notes" id="notes" class="validate">
                {% if job.notes is defined %} 
                    <option value="{{ job.notes }}" selected>{{ job.notes }}</option>
                {% else %}
                    <option value="" disabled selected>None</option>
                {% endif %}

                <option value="Multi-drop">Multi-drop</option>
                <option value="Cancellation" >Cancellation</option>
                <option value="Return" >Return</option>
                <option value="Co-load" >Co-load</option>
                <option value="Waiting time" >Waiting time</option>
            </select>
            <label for="notes">Notes:</label>
        </div>
    </div>

    {% if type == 'add' %}
        <!-- split -->
        <div class="row">
            <div class="input-field col s12">
                <div class="switch">
                    <!-- <i class="fas fa-pencil-alt prefix light-blue-text text-darken-4"></i> -->
                    <label for="split">
                            {% if job.split == 'on' %}
                                <input id="split" name="split" type="checkbox" checked>
                            {% else %}
                                <input id="split" name="split" type="checkbox">
                            {% endif %}
                        
                        <span class="lever split-lever"></span>
                        Split
                    </label>                          
                </div>
            </div>
        </div>

        <!-- next working date -->
        <!-- <div class="row"> -->
            <!-- <div class="input-field col s12 nwd-container hide"> -->
                <!-- <i class="fas fa-calendar prefix light-blue-text text-darken-4"></i> -->
                <!-- <input id="date_nwd" name="date_nwd"  type="text" class="datepicker"
                    {% if job is defined %}
                        value="{{ job.date_nwd}}"
                    {% endif %}
                    >
                <label for="date_nwd">Next working date:</label>
            </div>
        </div> -->
    {% endif %}

    <!-- submit button -->
    <div class="row">
        <div class="col s12 center-align">
            <button type="submit" class="btn-large submit">
                Submit <i class="fas fa-edit right"></i>
            </button>
        </div>
    </div>
{% endmacro %}



{% macro payslip(type, payslip, drivers, f) %}

    <!-- date -->
    <div class="row">
        <div class="input-field col s12">
            <!-- <i class="fas fa-calendar prefix light-blue-text text-darken-4"></i> -->
            <input id="date" name="date"  type="text" class="datepicker" required
                {% if payslip is defined and type == 'edit' %} 
                    value="{{ payslip.date }}" 
                {% elif payslip is defined %}
                    value="{{ payslip.date}}"
                {% endif %}
                >
            <label for="date">Date:</label>
        </div>
    </div>
    
    <!-- driver -->
    <div class="row">
        <div class="input-field col s12">
            <!-- <i class="fas fa-calendar prefix light-blue-text text-darken-4"></i> -->  
            <select name="driver_id" id="driver_id" class="validate" required>
                {% if payslip.driver_id is defined %}
                    {% for driver in drivers %}
                        {% if payslip.driver_id|int == driver.id|int %}
                            <option value="{{ driver.id }}" selected>{{ driver.full_name }}</option>
                        {% else %}
                            <option value="{{ driver.id }}">{{ driver.full_name }}</option>
                        {% endif %}
                    {% endfor %}        
                {% else %}
                    <option value="" disabled selected>Please select</option>
                    {% for driver in drivers %}
                            <option value="{{ driver.id }}" >{{ driver.full_name }}</option>
                    {% endfor %}   
                {% endif %}
            </select>
            <label for="driver_id">Select Driver:</label>
        </div>
    </div>

    <!-- total wage -->
    <div class="row">
        <div class="input-field col s12">
            <!-- <i class="fas fa-pencil-alt prefix light-blue-text text-darken-4"></i> -->
            <input id="total_wage" name="total_wage" type="number" step="0.01" required
                    {% if payslip.total_wage is defined and type == "edit" %} 
                        value="{{'%0.2f' % f.display_float(payslip.total_wage) }}" 
                    {% elif payslip.total_wage is defined %} 
                        value="{{payslip.total_wage}}" 
                    {% endif %}
                    >
            <label for="total_wage">Total wage (£):</label>
        </div>
    </div>

    <!-- total cost to employer -->
    <div class="row">
        <div class="input-field col s12">
            <!-- <i class="fas fa-pencil-alt prefix light-blue-text text-darken-4"></i> -->
            <input id="total_cost_to_employer" name="total_cost_to_employer" type="number" step="0.01" required
                    {% if payslip.total_cost_to_employer is defined and type == "edit" %} 
                        value="{{'%0.2f' % f.display_float(payslip.total_cost_to_employer) }}" 
                    {% elif payslip.total_cost_to_employer is defined %} 
                        value="{{payslip.total_cost_to_employer}}" 
                    {% endif %}
                    >
            <label for="total_cost_to_employer">Total cost to employer (£):</label>
        </div>
    </div>

    <!-- submit button -->
    <div class="row">
        <div class="col s12 center-align">
            <button type="submit" class="btn-large submit">
                Submit<i class="fas fa-edit right"></i>
            </button>
        </div>
    </div>
{% endmacro %}



{% macro fuel(type, fuel, trucks, f) %}
    <!-- date -->
    <div class="row">
        <div class="input-field col s12">
            <!-- <i class="fas fa-calendar prefix light-blue-text text-darken-4"></i> -->
            <input id="date" name="date" type="text" class="datepicker" required
                {% if fuel is defined and type == 'edit' %} 
                    value="{{ fuel.date }}" 
                {% elif fuel is defined %}
                    value="{{ fuel.date}}"
                {% endif %}
                >
            <label for="date">Date:</label>
        </div>
    </div>

    <!-- trucks -->
    <div class="row">
        <div class="input-field col s12">
            <!-- <i class="fas fa-calendar prefix light-blue-text text-darken-4"></i> -->  
            <select name="truck_id" id="truck_id" class="validate" required>
                {% if fuel.truck_id is defined %}
                    {% for truck in trucks %}
                        {% if fuel.truck == truck %}
                            <option value="{{ truck.id }}" selected>{{ truck.registration }}</option>
                        {% else %}
                            <option value="{{ truck.id }}">{{ truck.registration }}</option>
                        {% endif %}
                    {% endfor %}        
                {% else %}
                    <option value="" disabled selected>Please select</option>
                    {% for truck in trucks %}
                            <option value="{{ truck.id }}" >{{ truck.registration }}</option>
                    {% endfor %}   
                {% endif %}
            </select>
            <label for="truck_id">Truck:</label>
        </div>
    </div>

    <!-- fuel card name -->
    <div class="row">
        <div class="input-field col s12">
            <!-- <i class="fas fa-pencil-alt prefix light-blue-text text-darken-4"></i> -->
            <select name="fuel_card_name" id="fuel_card_name" class="validate" required>
                {% if fuel.fuel_card_name is defined %} 
                    <option value="{{ fuel.fuel_card_name }}" selected>{{ fuel.fuel_card_name }}</option>
                {% endif %}
                <option value="Silvey">Silvey</option>
                <option value="Fuel Card Services" >Fuel Card Services</option>
                <option value="UK Fuels">UK Fuels</option>
                <option value="The Fuel Card Company" >The Fuel Card Company</option>
            </select>
            <label for="fuel_card_name">Fuel card:</label>
        </div>
    </div>

    <!-- fuel volume -->
    <div class="row">
        <div class="input-field col s12">
            <!-- <i class="fas fa-pencil-alt prefix light-blue-text text-darken-4"></i> -->
            <input id="fuel_volume" name="fuel_volume" type="number" step="0.01" required
                    {% if fuel.fuel_volume is defined and type == "edit" %} 
                        value="{{'%0.2f' % f.display_float(fuel.fuel_volume) }}" 
                    {% elif fuel.fuel_volume is defined %} 
                        value="{{fuel.fuel_volume}}" 
                    {% endif %}
                    >
            <label for="fuel_volume">Fuel volume (L):</label>
        </div>
    </div>

    <!-- fuel cost -->
    <div class="row">
        <div class="input-field col s12">
            <!-- <i class="fas fa-pencil-alt prefix light-blue-text text-darken-4"></i> -->
            <input id="fuel_cost" name="fuel_cost" type="number" step="0.01" required
                    {% if fuel.fuel_cost is defined and type == "edit" %} 
                        value="{{'%0.2f' % f.display_float(fuel.fuel_cost) }}" 
                    {% elif fuel.fuel_cost is defined %} 
                        value="{{fuel.fuel_cost}}" 
                    {% endif %}
                    >
            <label for="fuel_cost">Fuel cost (£):</label>
        </div>
    </div>

    <!-- submit button -->
    <div class="row">
        <div class="col s12 center-align">
            <button type="submit" class="btn-large submit">
                Submit <i class="fas fa-edit right"></i>
            </button>
        </div>
    </div>
{% endmacro %}



{% macro expense(type, expense, f) %}
    <!-- expense name -->
    <div class="row">
        <div class="input-field col s12">
            <!-- <i class="fas fa-pencil-alt prefix light-blue-text text-darken-4"></i> -->
            <input id="name" name="name" type="text" required
            {% if expense.name is defined %} 
            value="{{ expense.name }}" 
            {% endif %}
            >
            <label for="name">Name:</label>
        </div>
    </div>

    <!-- expense description -->
    <div class="row">
        <div class="input-field col s12">
            <!-- <i class="fas fa-pencil-alt prefix light-blue-text text-darken-4"></i> -->
            <input id="description" name="description" type="text" required
            {% if expense.description is defined %} 
            value="{{ expense.description }}" 
            {% endif %}
            >
            <label for="name">Description:</label>
        </div>
    </div>
    
    <!-- date -->
    <div class="row">
        <div class="input-field col s12">
            <!-- <i class="fas fa-calendar prefix light-blue-text text-darken-4"></i> -->
            <input id="date" name="start_date"  type="text" class="datepicker" required
                {% if expense is defined and type == 'edit' %} 
                    value="{{ expense.start_date }}" 
                {% elif expense is defined %}
                    value="{{ expense.start_date }}"
                {% endif %}
                >
            <label for="date">Date:</label>
        </div>
    </div>

    <!-- cost -->
    <div class="row">
        <div class="input-field col s12">
            <!-- <i class="fas fa-pencil-alt prefix light-blue-text text-darken-4"></i> -->
            <input id="cost" name="cost" type="number" step="0.01" required
                    {% if expense.cost is defined and type == "edit" %} 
                        value="{{ '%0.2f' % f.display_float(expense.cost) }}" 
                    {% elif expense.cost is defined %} 
                        value="{{ expense.cost }}" 
                    {% endif %}
                    >
            <label for="cost">Expense cost (£):</label>
        </div>
    </div>

    <!-- submit button -->
    <div class="row">
        <div class="col s12 center-align">
            <button type="submit" class="btn-large submit">
                Submit <i class="fas fa-edit right"></i>
            </button>
        </div>
    </div>
{% endmacro %}


{% set positive %}<i class="material-icons green-text tiny bold">add</i>{% endset %}
{% set negative %}<i class="material-icons red-text tiny bold">remove</i>{% endset %}
{% macro driver_card(driver_id, data, f) %}
    <div class="col s12 xl4">
        <div class="card wages-card small">
            <div class="card-content ">
                <span class="card-title bold"><h5>{{ data.driver.full_name }}</h5>
                    <!-- <i class="material-icons right">more_vert</i> -->
                    <div class="divider"></div>
                </span>
                <div>
                    <br>
                    {% if '/wages_calculator' in request.path %}
                        <p class="wages-calc-card-text">{{positive}} Total Earned: {{ f.fd_currency(data.total_earned) }}</p>
                        <p class="wages-calc-card-text bold">{{positive}} Extras: {{ f.fd_currency(data.weekly_extras) }}</p>
                        <p class="wages-calc-card-text">{{positive}} Overnights: {{ f.fd_currency(data.total_overnight) }}</p>
                        <p class="wages-calc-card-text">{{positive}} Gross Pay: {{ f.fd_currency(data.gross_pay) }}</p>
                    {% endif %}
                    {% if '/analysis/' in request.path %}
                        <p class="wages-calc-card-text">{{positive}} Total Earned: {{ f.fd_currency_rd(data.total_earned) }}</p>
                        <p class="wages-calc-card-text ">{{negative}} Overheads: {{ f.fd_currency_rd(data.expenses) }}</p>
                        <p class="wages-calc-card-text {{'italics' if data.estimated == True }}">
                            {{negative}}
                            Wages Cost: {{ f.fd_currency_rd(data.total_cost_to_employer) }}{{ '*' if data.estimated==True}}
                        </p>
                    {% if '/analysis/' in request.path %}
                    {% if data.truck is not none %}
                    {{ truck_card_data_only_short(data.truck_data.truck_id, data.truck_data, f) }}
                    {% else %}
                        <p class="grey-text">No Truck Assigned</p>
                    {% endif %}

                    {% endif %}
                    {% endif %}
                </div>
            </div>
            {% if '/wages_calculator' in request.path %}
            <div class="card-action">
                <a href="#modal_{{ driver_id }}" class="waves-effect waves-light blue darken-2 white-text btn-flat modal-trigger wc-button"><i class="material-icons tiny left">today</i>Days</a>
                <a href="#modal_timetable_{{ driver_id }}" class="waves-effect waves-light blue darken-2 white-text btn-flat modal-trigger wc-button"><i class="material-icons tiny left">list</i>Jobs</a>
            </div>
        </div>
        <div>
            {% if data.day_entries|length < 5 %}
            <p class="wages-calc-card-text orange-text text-small valign-wrapper no-margin"><i class="material-icons">warning</i>  Only {{data.day_entries |length}} day(s) recorded.</p>
            <a class="text-small" href="{{ url_for('day.add_day', item_id=0, tab='history') }} ">Add Day entries</a><br>
            <a class="text-small" href="{{ url_for('job.add_job', item_id=0, tab='entry', user_confirm='False') }}">Add Job entries</a>
            {% endif %}
        </div>
        {% else %}
        <div class="card-action">
            <span class="card-title wages-calc-card-text activator {{'italics' if estimated}}
            {{'green-text bold' if f.display_float(data.profit) > 500}}">
                {% if data.truck_data.total_fuel_cost == 0 %}
                Waiting on fuel data.
                    {% else %}
                Profit: {{f.fd_currency_rd(data.profit)}}{{ '*' if estimated}}<i class="material-icons right">more_vert</i>
                {% endif %}
            </span>
        </div>
        <div class="card-reveal">
            <span class="card-title grey-text text-darken-4">Card Title<i class="material-icons right">close</i></span>
            <p>Here is some more information about this product that is only revealed once clicked on.</p>

          </div>
        </div>
        {% endif %}
    </div>
    
    <!-- WEEK BREAKDOWN MODAL -->
    <div id="modal_{{ driver_id }}" class="modal">
        <div class="modal-content">
            <h4>{{ data.driver.full_name }}'s breakdown</h4>
            <p class=""><a href="{{ url_for('day.add_day', item_id=0, tab='history') }}">Click here to edit/delete history.</a></p>
            <table class="centered">
                <thead>
                    <tr>
                        <th>Date</th>
                        <th>Earned</th>
                        <th>Daily bonus</th>
                        <th>Overnight</th>
                    </tr>
                </thead>
                
                <tbody>
                    {% for day in data.day_entries %}    
                    <tr>
                        {% if day.status != 'working' %}
                        <td>{{ f.display_date(day.date) }}</td>
                        <td class="grey-text">{{ day.status.capitalize() }}</td>
                        <td class="grey-text">{{ day.status.capitalize() }}</td>
                        <td class="grey-text">{{ day.status.capitalize() }}</td>
                        {% else %}
                        <td>{{ f.display_date(day.date) }}</td>
                        <td>{{ f.fd_currency(day.calculate_total_earned()) }}</td>
                        <td>{{ f.fd_currency(day.calculate_daily_bonus(data.driver)) }}</td>
                        <td>{% if day.overnight %}
                            <i class="material-icons green-text">check</i> 
                            {% else %}
                            <i class="material-icons">remove</i>
                            {% endif %}
                        </td>
                        {% endif %}
                    </tr>
                    {% endfor %}
                    <tr class="table-breaker">
                    </tr>
                    <tr class="totals-row">
                        <td><em>Totals:</em></td>
                        <td><em>{{ f.fd_currency(data.total_earned) }}</em></td>
                        <td><em>{# f.fd_currency(data.weekly_total_bonus_wage) #}</em></td>
                        <td><em>{# f.fd_currency(data.weekly_total_overnight) #}</em></td>
                    </tr>
                </tbody>
            </table> 
        </div>
        <div class="modal-footer">
            <a href="#!" class="modal-close waves-effect waves-green btn-flat">Close</a>
        </div>
    </div>
    
    <!-- WEEK TIMETABLE MODAL -->
    <div id="modal_timetable_{{ driver_id }}" class="modal">
        
        <div class="modal-content">
            <h4>{{ data.driver.full_name }}'s timetable</h4>
            <p class=""><a href="{{ url_for('job.add_job', item_id=0, tab='history', user_confirm='False') }}">Click here to edit/delete history.</a></p>
            <table class="centered">
                <thead>
                    <tr>
                        <th>Date</th>
                        <th>Collection</th>
                        <th>Delivery</th>
                        <th>Earned</th>
                        <th>Split?</th>
                    </tr>
                </thead>
                
                <tbody>
                    {% for job in data.job_entries %}    
                    <tr>
                        <td>{{ f.display_date(job.day.date) }}</td>
                        <td>{{ job.collection | capitalize }}</td>
                        <td>{{ job.delivery | capitalize }}</td>
                        <td>{{ f.fd_currency(job.earned) }}</td>
                        <td>{% if job.split %}
                            <i class="material-icons green-text">check</i> 
                            {% else %}
                            <i class="material-icons">remove</i>
                            {% endif %}
                        </td>
                    </tr>
                    {% endfor %}
                    <tr class="table-breaker">
                    </tr>

                </tbody>
            </table> 
        </div>
        <div class="modal-footer">
            <a href="#!" class="modal-close waves-effect waves-green btn-flat">Close</a>
        </div>
    </div>
    
{% endmacro %}

{% macro truck_card_data_only(truck_id, data, f) %}
<div>
    {% if data.estimated == True %}
    <p class="wages-calc-card-text italics">{{negative}} Fuel Cost: {{ f.fd_currency_rd(data.total_fuel_cost) }}*</p>
    <br>
    <p class="wages-calc-card-text italics grey-text">Fuel Used: {{ f.display_float(data.total_fuel_volume) | int }} L*</p>
    {% else %}
    <p class="wages-calc-card-text">{{negative}} Fuel Cost: {{ f.fd_currency_rd(data.total_fuel_cost) }}</p>
    <br>
    <p class="wages-calc-card-text grey-text">Fuel Used: {{ f.display_float(data.total_fuel_volume) | int }} L</p>
    <p class="wages-calc-card-text text-small grey-text">(Fuel Economy: {{ data.fuel_economy }} mpg)</p>
    {% endif %}
    <p class="wages-calc-card-text grey-text">Mileage: {{ f.display_float(data.total_mileage) | int }} miles</p>
</div>
{% endmacro %}
{% macro truck_card_data_only_short(truck_id, data, f) %}
    {% if data.estimated == True %}
        <p class="wages-calc-card-text italics">{{negative}} Fuel Cost: {{ f.fd_currency_rd(data.total_fuel_cost) }}*</p>
    {% else %}
        <p class="wages-calc-card-text">{{negative}} Fuel Cost: {{ f.fd_currency_rd(data.total_fuel_cost) }}</p>
    {% endif %}
{% endmacro %}




{% macro truck_card(truck_id, data, f) %}
    <div class="col s12 xl4">
        <div class="card hoverable wages-card small">
            <div class="card-content">
                <span class="card-title activator"><h5>{{ data.truck.registration }}</h5>
                    <!-- <i class="material-icons right">more_vert</i> -->
                    <div class="divider"></div>
                </span>
                <div>
                    <p class="wages-calc-card-text">Mileage: {{ f.display_float(data.total_mileage) | int }} miles</p>
                    {% if data.estimated == True %}
                    <p class="wages-calc-card-text italics">Fuel Used: {{ f.display_float(data.total_fuel_volume) | int }} L*</p><br>
                    <p class="wages-calc-card-text italics bold">Fuel Cost: {{ f.fd_currency(data.total_fuel_cost) }}*</p>
                    {% else %}
                    <p class="wages-calc-card-text">Fuel Used: {{ f.display_float(data.total_fuel_volume) | int }} L</p><br>
                    <p class="wages-calc-card-text bold">Fuel Cost: {{ f.fd_currency(data.total_fuel_cost) }}</p>
                    <p class="wages-calc-card-text text-small grey-text">(Fuel Economy: {{ data.fuel_economy }} mpg)</p>
                    {% endif %}
                </div>

            </div>
        </div>
    </div>
{% endmacro %}

{% macro navigation() %}
  {% if request.path.count('/') > 1 %}
    <a href="{{ url_for('home') }}">
        <i class="small material-icons black-text">arrow_back</i>
    </a>
  {% else %}
    <ul id="slide-out" class="sidenav">
        <!-- <li>
            <div class="user-view">
                <div class="background">
                    <img src="images/office.jpg">
                </div>
                <a href="#user"><img class="circle" src="images/yuna.jpg"></a>
                <a href="#name"><span class="white-text name">John Doe</span></a>
                <a href="#email"><span class="white-text email">jdandturk@gmail.com</span></a>
            </div>
        </li> -->
        <li><a class="subheader">Settings</a></li>
        <li><a href="{{ url_for('driver.add_driver', item_id=0, tab='entry') }}"><i class="material-icons">person_add</i>Add Driver</a></li>
        <li><a href="{{ url_for('truck.add_truck', item_id=0, tab='entry') }}"><i class="material-icons">local_shipping</i>Add Truck</a></li>
        <li><a href="{{ url_for('expense.add_expense', item_id=0, tab='entry') }}"><i class="material-icons">format_list_bulleted</i>Add Expense</a></li>
        <li><div class="divider"></div></li>
        <li><a class="subheader">Tools</a></li>
        <li><a href="{{ url_for('wages_calculator.wages_calculator') }}"><i class="material-icons">attach_money</i>Wages Calculator</a></li>
        <li class="">
            <ul class="collapsible collapsible-accordion">
                <li>
                    <a class="collapsible-header"><i class="material-icons">arrow_drop_down</i>Analysis</a>
                    <div class="collapsible-body">
                        <ul>
                            <li><a href="{{ url_for('analysis.weekly_analysis') }}"><i
                                class="material-icons">show_chart</i>Weekly Analysis</a></li>
                            <li><a href="{{ url_for('analysis.monthly_analysis') }}"><i
                                class="material-icons">event</i>Monthly Analysis</a></li>
                        </ul>
                    </div>
                </li>
            </ul>
        </li>

    </ul>
    <a href="#" data-target="slide-out" class="sidenav-trigger material-icons "><i class="small material-icons black-text">menu</i></a>
  {% endif %}
{% endmacro %}

















